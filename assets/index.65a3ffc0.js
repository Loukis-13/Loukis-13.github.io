import{P as j}from"./index.e18b59bf.js";let o;const u=new Array(128).fill(void 0);u.push(void 0,null,!0,!1);function B(e){return u[e]}let p=u.length;function Y(e){e<132||(u[e]=p,p=e)}function $(e){const t=B(e);return Y(e),t}const P=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&P.decode();let h=null;function E(){return(h===null||h.byteLength===0)&&(h=new Uint8Array(o.memory.buffer)),h}function T(e,t){return e=e>>>0,P.decode(E().subarray(e,e+t))}let y=null;function I(){return(y===null||y.byteLength===0)&&(y=new Int32Array(o.memory.buffer)),y}function H(e){return()=>{throw new Error(`${e} is not defined`)}}function N(e){p===u.length&&u.push(u.length+1);const t=p;return p=u[t],u[t]=e,t}let M=0;const A=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Z=typeof A.encodeInto=="function"?function(e,t){return A.encodeInto(e,t)}:function(e,t){const n=A.encode(e);return t.set(n),{read:e.length,written:n.length}};function J(e,t,n){if(n===void 0){const l=A.encode(e),b=t(l.length,1)>>>0;return E().subarray(b,b+l.length).set(l),M=l.length,b}let r=e.length,i=t(r,1)>>>0;const d=E();let s=0;for(;s<r;s++){const l=e.charCodeAt(s);if(l>127)break;d[i+s]=l}if(s!==r){s!==0&&(e=e.slice(s)),i=n(i,r,r=s+e.length*3,1)>>>0;const l=E().subarray(i+s,i+r);s+=Z(e,l).written,i=n(i,r,s,1)>>>0}return M=s,i}const D=Object.freeze({Dead:0,0:"Dead",Alive:1,1:"Alive"}),S=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_universe_free(e>>>0));class L{static __wrap(t){t=t>>>0;const n=Object.create(L.prototype);return n.__wbg_ptr=t,S.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,S.unregister(this),t}free(){const t=this.__destroy_into_raw();o.__wbg_universe_free(t)}static new(){const t=o.universe_new();return L.__wrap(t)}width(){return o.universe_width(this.__wbg_ptr)>>>0}height(){return o.universe_height(this.__wbg_ptr)>>>0}cells(){return o.universe_cells(this.__wbg_ptr)>>>0}set_width(t){o.universe_set_width(this.__wbg_ptr,t)}set_height(t){o.universe_set_height(this.__wbg_ptr,t)}render(){let t,n;try{const d=o.__wbindgen_add_to_stack_pointer(-16);o.universe_render(d,this.__wbg_ptr);var r=I()[d/4+0],i=I()[d/4+1];return t=r,n=i,T(r,i)}finally{o.__wbindgen_add_to_stack_pointer(16),o.__wbindgen_free(t,n,1)}}tick(){o.universe_tick(this.__wbg_ptr)}toggle_cell(t,n){o.universe_toggle_cell(this.__wbg_ptr,t,n)}set_cell_alive(t,n){o.universe_set_cell_alive(this.__wbg_ptr,t,n)}clear(){o.universe_clear(this.__wbg_ptr)}restart(){o.universe_restart(this.__wbg_ptr)}}async function Q(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(r){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}else{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}function ee(){const e={};return e.wbg={},e.wbg.__wbindgen_object_drop_ref=function(t){$(t)},e.wbg.__wbg_random_26e2d782b541ca6b=typeof Math.random=="function"?Math.random:H("Math.random"),e.wbg.__wbg_new_abda76e883ba8a5f=function(){const t=new Error;return N(t)},e.wbg.__wbg_stack_658279fe44541cf6=function(t,n){const r=B(n).stack,i=J(r,o.__wbindgen_malloc,o.__wbindgen_realloc),d=M;I()[t/4+1]=d,I()[t/4+0]=i},e.wbg.__wbg_error_f851667af71bcfc6=function(t,n){let r,i;try{r=t,i=n,console.error(T(t,n))}finally{o.__wbindgen_free(r,i,1)}},e.wbg.__wbindgen_throw=function(t,n){throw new Error(T(t,n))},e}function te(e,t){return o=e.exports,U.__wbindgen_wasm_module=t,y=null,h=null,o}async function U(e){if(o!==void 0)return o;typeof e>"u"&&(e=new URL("/assets/wasm_game_of_life_bg.501d5404.wasm",self.location));const t=ee();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await Q(await e,t);return te(n,r)}const ne="/assets/pause.0de8eaf3.svg",re=await U(),c=5,oe="#CCCCCC",ie="#FFFFFF",se="#000000",a=L.new(),f=a.width(),w=a.height(),g=document.getElementById("game-of-life-canvas");g.height=(c+1)*w+1;g.width=(c+1)*f+1;const _=g.getContext("2d");g.addEventListener("click",e=>{const t=g.getBoundingClientRect(),n=g.width/t.width,r=g.height/t.height,i=(e.clientX-t.left)*n,d=(e.clientY-t.top)*r,s=Math.min(Math.floor(d/(c+1)),w-1),l=Math.min(Math.floor(i/(c+1)),f-1);if(e.shiftKey)a.set_cell_alive(s,l),a.set_cell_alive(s,l-1),a.set_cell_alive(s,l-2),a.set_cell_alive(s-1,l),a.set_cell_alive(s-2,l-1);else if(e.ctrlKey){let b=[[1,2],[1,3],[1,4],[2,1],[3,1],[4,1],[6,2],[6,3],[6,4],[2,6],[3,6],[4,6]];for(let[G,K]of[[1,1],[1,-1],[-1,1],[-1,-1]])for(const[V,X]of b){let C=(s+V*G)%w,R=(l+X*K)%f;C<0&&(C+=w),R<0&&(R+=f),a.set_cell_alive(C,R)}}else a.toggle_cell(s,l);F(),m()});const z=document.getElementById("fps-control");z.addEventListener("input",e=>{O=1e3/+e.target.value});let k=null,O=1e3/+z.value,v;const q=e=>{v===void 0&&(v=e);const t=e-v;t>O&&(v=e-t%O,a.tick(),F(),m()),k=requestAnimationFrame(q)},F=()=>{_.beginPath(),_.strokeStyle=oe;for(let e=0;e<=f;e++)_.moveTo(e*(c+1)+1,0),_.lineTo(e*(c+1)+1,(c+1)*w+1);for(let e=0;e<=w;e++)_.moveTo(0,e*(c+1)+1),_.lineTo((c+1)*f+1,e*(c+1)+1);_.stroke()},W=(e,t)=>e*f+t,m=()=>{const e=a.cells(),t=new Uint8Array(re.memory.buffer,e,f*w);_.beginPath(),_.fillStyle=se;for(let n=0;n<w;n++)for(let r=0;r<f;r++){const i=W(n,r);t[i]===D.Alive&&_.fillRect(r*(c+1)+1,n*(c+1)+1,c,c)}_.fillStyle=ie;for(let n=0;n<w;n++)for(let r=0;r<f;r++){const i=W(n,r);t[i]===D.Dead&&_.fillRect(r*(c+1)+1,n*(c+1)+1,c,c)}_.stroke()};document.getElementById("kill-all").addEventListener("click",e=>{a.clear(),m()});document.getElementById("restart").addEventListener("click",e=>{a.restart(),m()});const x=document.getElementById("play-pause"),ce=()=>k===null,le=()=>{x.src=ne,q()},ae=()=>{x.src=j,cancelAnimationFrame(k),k=null};x.addEventListener("click",e=>{ce()?le():ae()});F();m();x.src=j;
